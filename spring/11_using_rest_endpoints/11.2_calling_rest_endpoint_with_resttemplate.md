## 11.2 RestTemplate으로 REST 엔드포인트 호출

### 호출 단계

1. `HttpHeaders` 인스턴스 생성 및 구성하여 HTTP 헤더를 정의함.
2. 요청 데이터(헤더와 본문을 나타내는 ``HttpEntity` 인스턴스)를 생성함.
3. `exchange()` 메서드를 사용하여 HTTP 호출을 전송하고 HTTP 응답을 수신함.

![image](https://github.com/user-attachments/assets/cf7750f7-1289-421c-85b8-7ea489d3ec72)

### 1. 프록시 클래스 정의

```java
@Component
public class PaymentsProxy {
  private final RestTemplate rest;

  @Value("${name.service.url}")
  private String paymentsServiceUrl;

  public Payment createPayment(Payment payment) {
    String uri = paymentsServiceUrl + "/payment";
    HttpHeaders headers = new HttpHeaders();
    headers.add("requestId", UUID.randomUUID().toString());

    HttpEntity<Payment> httpEntity = new HttpEntity<>(payment, headers);
    ResponseEntity<Payment> response = rest.exchange(uri, HttpMethod.POST, httpEntity, Payment.class);
    return response.getBody();
  }
}
```

### 2. 컨트롤러 정의

```java
@RestController
public class PaymentsController {
  private final PaymentsProxy paymentsProxy;

  @PostMapping("/payment")
  public Payment createPayment(@RequestBody Payment payment) {
    return paymentsProxy.createPayment(payment);
  }
}
```

### cURL 명령

```bash
curl -X POST -H 'content-type:application/json' -d '{"amount":1000}' http://localhost:9090/payment
```

```bash
{
"id":"21149959-d93d-41a4-a0a3-426c6fd8f9e9",
"amount":1000.0
}
```

## ⁉️예상 질문

1. RestTemplate이란 무엇이며, 어떤 상황에서 사용하는지 설명해주세요.

&nbsp;

※ 자세한 내용은 [블로그](https://mandusitstudy.tistory.com/442)를 참고해주세요.